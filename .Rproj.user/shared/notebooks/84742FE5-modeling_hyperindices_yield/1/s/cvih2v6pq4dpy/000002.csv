"0","#####################################################################################################"
"0","# predicting hm"
"0","drybean.sub <- drybean %>%"
"0","  select(hm, ends_with(""_mean"")) %>%"
"0","  na.omit()"
"0",""
"0",""
"0","# where are the coefficients NA. We will remove these from the model"
"0","drybean.reduced <- drybean.sub %>% select(-c(X9_mean, X18_mean, X19_mean, X27_mean,"
"0","                                            X28_mean,  X29_mean, X36_mean,  X37_mean, X38_mean,"
"0","                                            X39_mean, X45_mean,  X46_mean, X47_mean,  X48_mean,"
"0","                                            X49_mean,  X54_mean, X55_mean,  X56_mean, X57_mean,"
"0","                                            X58_mean, X59_mean,  X63_mean, X64_mean,  X65_mean, "
"0","                                            X66_mean,  X67_mean, X68_mean,  X69_mean, X72_mean, "
"0","                                            X73_mean, X74_mean,  X75_mean, X76_mean,  X77_mean,"
"0","                                            X78_mean,  X79_mean, X81_mean, X82_mean,  X83_mean,"
"0","                                            X84_mean, X85_mean, X86_mean,  X87_mean, X88_mean,"
"0","                                            X89_mean))"
"0",""
"0","# run a linear model fit and see if there are some really collinear variables"
"0","# due to the nature of the hyperspectral indices, there are many colinear variables"
"0","# present in the dataset. lets remove some of those."
"0","#lm.fit <- lm(em ~ ., data = drybean.sub[,2:ncol(drybean.sub)])"
"0","#summary(lm.fit)"
"0",""
"0","# # Split the data into training and test set"
"0","set.seed(123)"
"0","training.samples <- drybean.reduced$hm %>%"
"0","  createDataPartition(p = 0.8, list = FALSE)"
"0","train.data  <- drybean.reduced[training.samples, ]"
"0","test.data <- drybean.reduced[-training.samples, ]"
"0",""
"0","# create a multiple regression model using all predictors"
"0","lm.fit <- lm(hm ~ ., data = train.data)"
"0","summary(lm.fit)"
"1","
Call:
"
"1",""
"1","lm(formula = hm ~ ., data = train.data)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","    Min "
"1","     1Q "
"1"," Median "
"1","     3Q "
"1","    Max "
"1","
"
"1","-3.9080 "
"1","-0.9132 "
"1","-0.0566 "
"1"," 1.0522 "
"1"," 4.9454 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1"," Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","   "
"1","
(Intercept)"
"1","   1593.9"
"1","      763.1"
"1","   2.089"
"1","  0.04207"
"1"," * "
"1","
X0_mean    "
"1","  -1994.6"
"1","     2003.1"
"1","  -0.996"
"1","  0.32435"
"1","   "
"1","
X1_mean    "
"1","   1663.5"
"1","     8784.2"
"1","   0.189"
"1","  0.85060"
"1","   "
"1","
X2_mean    "
"1","   4282.3"
"1","     9938.8"
"1","   0.431"
"1","  0.66849"
"1","   "
"1","
X3_mean    "
"1","   -686.0"
"1","     2718.7"
"1","  -0.252"
"1","  0.80187"
"1","   "
"1","
X4_mean    "
"1","     75.6"
"1","     2751.9"
"1","   0.027"
"1","  0.97820"
"1","   "
"1","
X5_mean    "
"1","  -6363.4"
"1","    11430.8"
"1","  -0.557"
"1","  0.58032"
"1","   "
"1","
X6_mean    "
"1"," -15036.1"
"1","     6566.3"
"1","  -2.290"
"1","  0.02647"
"1"," * "
"1","
X7_mean    "
"1","   3125.2"
"1","     3688.7"
"1","   0.847"
"1","  0.40107"
"1","   "
"1","
X8_mean    "
"1","  13558.2"
"1","    12108.7"
"1","   1.120"
"1","  0.26841"
"1","   "
"1","
X10_mean   "
"1","  -7117.1"
"1","     8084.4"
"1","  -0.880"
"1","  0.38306"
"1","   "
"1","
X11_mean   "
"1","  -4814.4"
"1","     8843.6"
"1","  -0.544"
"1","  0.58869"
"1","   "
"1","
X12_mean   "
"1","  -3859.4"
"1","     2311.1"
"1","  -1.670"
"1","  0.10144"
"1","   "
"1","
X13_mean   "
"1","   9176.6"
"1","     3331.9"
"1","   2.754"
"1","  0.00829"
"1"," **"
"1","
X14_mean   "
"1","    375.0"
"1","     8317.0"
"1","   0.045"
"1","  0.96423"
"1","   "
"1","
X15_mean   "
"1","  10581.6"
"1","     6026.4"
"1","   1.756"
"1","  0.08549"
"1"," . "
"1","
X16_mean   "
"1","  -2119.7"
"1","     3374.3"
"1","  -0.628"
"1","  0.53285"
"1","   "
"1","
X17_mean   "
"1","   -166.9"
"1","     8542.6"
"1","  -0.020"
"1","  0.98449"
"1","   "
"1","
X20_mean   "
"1"," -40567.8"
"1","    25523.8"
"1","  -1.589"
"1","  0.11853"
"1","   "
"1","
X21_mean   "
"1"," -10174.0"
"1","    20421.2"
"1","  -0.498"
"1","  0.62061"
"1","   "
"1","
X22_mean   "
"1","  36575.0"
"1","    42964.5"
"1","   0.851"
"1","  0.39884"
"1","   "
"1","
X23_mean   "
"1","   2306.5"
"1","    15073.1"
"1","   0.153"
"1","  0.87902"
"1","   "
"1","
X24_mean   "
"1","  -5674.6"
"1","    13136.9"
"1","  -0.432"
"1","  0.66771"
"1","   "
"1","
X25_mean   "
"1","  18470.5"
"1","    11101.3"
"1","   1.664"
"1","  0.10267"
"1","   "
"1","
X26_mean   "
"1","  -6500.9"
"1","    15792.9"
"1","  -0.412"
"1","  0.68244"
"1","   "
"1","
X30_mean   "
"1","  22791.5"
"1","    22038.8"
"1","   1.034"
"1","  0.30625"
"1","   "
"1","
X31_mean   "
"1"," -50480.1"
"1","    44288.5"
"1","  -1.140"
"1","  0.26003"
"1","   "
"1","
X32_mean   "
"1","  -7182.9"
"1","    17275.4"
"1","  -0.416"
"1","  0.67942"
"1","   "
"1","
X33_mean   "
"1","   8826.6"
"1","    15515.8"
"1","   0.569"
"1","  0.57209"
"1","   "
"1","
X34_mean   "
"1"," -24190.3"
"1","    12232.9"
"1","  -1.977"
"1","  0.05375"
"1"," . "
"1","
X35_mean   "
"1","   9417.4"
"1","    17587.2"
"1","   0.535"
"1","  0.59480"
"1","   "
"1","
X40_mean   "
"1","   8427.4"
"1","     6153.5"
"1","   1.370"
"1","  0.17721"
"1","   "
"1","
X41_mean   "
"1","  14988.8"
"1","     7144.7"
"1","   2.098"
"1","  0.04120"
"1"," * "
"1","
X42_mean   "
"1","   6835.1"
"1","     5267.8"
"1","   1.298"
"1","  0.20065"
"1","   "
"1","
X43_mean   "
"1","  -3599.5"
"1","     5523.7"
"1","  -0.652"
"1","  0.51774"
"1","   "
"1","
X44_mean   "
"1"," -17474.5"
"1","     6781.5"
"1","  -2.577"
"1","  0.01310"
"1"," * "
"1","
X50_mean   "
"1","  -6518.1"
"1","     8103.4"
"1","  -0.804"
"1","  0.42515"
"1","   "
"1","
X51_mean   "
"1","  -5229.3"
"1","     6729.4"
"1","  -0.777"
"1","  0.44092"
"1","   "
"1","
X52_mean   "
"1","   7221.0"
"1","     7068.6"
"1","   1.022"
"1","  0.31211"
"1","   "
"1","
X53_mean   "
"1","   6972.0"
"1","     6834.4"
"1","   1.020"
"1","  0.31278"
"1","   "
"1","
X60_mean   "
"1","  -7869.2"
"1","    16297.4"
"1","  -0.483"
"1","  0.63139"
"1","   "
"1","
X61_mean   "
"1","   3161.8"
"1","     8054.5"
"1","   0.393"
"1","  0.69639"
"1","   "
"1","
X62_mean   "
"1","   4771.1"
"1","     9157.3"
"1","   0.521"
"1","  0.60475"
"1","   "
"1","
X70_mean   "
"1","  -2702.1"
"1","     6235.2"
"1","  -0.433"
"1","  0.66670"
"1","   "
"1","
X71_mean   "
"1","  -3239.0"
"1","    15278.1"
"1","  -0.212"
"1","  0.83300"
"1","   "
"1","
X80_mean   "
"1","  -2141.5"
"1","     8605.2"
"1","  -0.249"
"1","  0.80453"
"1","   "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","2.214"
"1"," "
"1","on"
"1"," "
"1","48"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.7855"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.5844"
"1"," "
"1","
F-statistic:"
"1"," "
"1","3.906"
"1"," "
"1","on"
"1"," "
"1","45"
"1"," "
"1","and"
"1"," "
"1","48"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","3.561e-06"
"1","
"
"1","
"
"0","# predict using test data"
"0","predictions <- lm.fit %>% predict(test.data)"
"0",""
"0","# compute R MSE"
"0","RMSE <- RMSE(predictions, test.data$hm)"
"0",""
"0","# compute R-square"
"0","R2 <- R2(predictions, test.data$hm)"
"0",""
"0","# return results"
"0","print(paste(""RMSE = "", RMSE))"
"1","[1]"
"1"," ""RMSE =  3.51482685772334"""
"1","
"
"0","print(paste(""R-squared value is:"", R2))"
"1","[1]"
"1"," ""R-squared value is: 0.0800821955118845"""
"1","
"
