"0",""
"0","#####################################################################################################"
"0","# predicting 100 seed weight"
"0","drybean.sub <- drybean %>%"
"0","  select(sdwt, ends_with(""_mean"")) %>%"
"0","  na.omit()"
"0",""
"0",""
"0","# where are the coefficients NA. We will remove these from the model"
"0","drybean.reduced <- drybean.sub %>% select(-c(X9_mean, X18_mean, X19_mean, X27_mean,"
"0","                                            X28_mean,  X29_mean, X36_mean,  X37_mean, X38_mean,"
"0","                                            X39_mean, X45_mean,  X46_mean, X47_mean,  X48_mean,"
"0","                                            X49_mean,  X54_mean, X55_mean,  X56_mean, X57_mean,"
"0","                                            X58_mean, X59_mean,  X63_mean, X64_mean,  X65_mean, "
"0","                                            X66_mean,  X67_mean, X68_mean,  X69_mean, X72_mean, "
"0","                                            X73_mean, X74_mean,  X75_mean, X76_mean,  X77_mean,"
"0","                                            X78_mean,  X79_mean, X81_mean, X82_mean,  X83_mean,"
"0","                                            X84_mean, X85_mean, X86_mean,  X87_mean, X88_mean,"
"0","                                            X89_mean))"
"0",""
"0","# run a linear model fit and see if there are some really collinear variables"
"0","# due to the nature of the hyperspectral indices, there are many colinear variables"
"0","# present in the dataset. lets remove some of those."
"0","#lm.fit <- lm(em ~ ., data = drybean.sub[,2:ncol(drybean.sub)])"
"0","#summary(lm.fit)"
"0",""
"0","# # Split the data into training and test set"
"0","set.seed(123)"
"0","training.samples <- drybean.reduced$sdwt %>%"
"0","  createDataPartition(p = 0.8, list = FALSE)"
"0","train.data  <- drybean.reduced[training.samples, ]"
"0","test.data <- drybean.reduced[-training.samples, ]"
"0",""
"0","# create a multiple regression model using all predictors"
"0","lm.fit <- lm(sdwt ~ ., data = train.data)"
"0","summary(lm.fit)"
"1","
Call:
"
"1",""
"1","lm(formula = sdwt ~ ., data = train.data)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","    Min "
"1","     1Q "
"1"," Median "
"1","     3Q "
"1","    Max "
"1","
"
"1","-4.8586 "
"1","-1.4268 "
"1","-0.2463 "
"1"," 1.4376 "
"1"," 6.6648 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1"," Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","  "
"1","
(Intercept)"
"1","  -1119.4"
"1","      938.5"
"1","  -1.193"
"1","   0.2387"
"1","  "
"1","
X0_mean    "
"1","   2604.3"
"1","     3858.1"
"1","   0.675"
"1","   0.5028"
"1","  "
"1","
X1_mean    "
"1","   4897.0"
"1","    11344.7"
"1","   0.432"
"1","   0.6679"
"1","  "
"1","
X2_mean    "
"1","  -9932.2"
"1","    12671.7"
"1","  -0.784"
"1","   0.4369"
"1","  "
"1","
X3_mean    "
"1","  -6354.1"
"1","     3818.7"
"1","  -1.664"
"1","   0.1025"
"1","  "
"1","
X4_mean    "
"1","   5998.5"
"1","     3945.5"
"1","   1.520"
"1","   0.1348"
"1","  "
"1","
X5_mean    "
"1","  14013.6"
"1","    15413.4"
"1","   0.909"
"1","   0.3677"
"1","  "
"1","
X6_mean    "
"1","  -2336.6"
"1","    10121.3"
"1","  -0.231"
"1","   0.8184"
"1","  "
"1","
X7_mean    "
"1","   4711.2"
"1","     4746.8"
"1","   0.992"
"1","   0.3258"
"1","  "
"1","
X8_mean    "
"1"," -12613.5"
"1","    17107.7"
"1","  -0.737"
"1","   0.4645"
"1","  "
"1","
X10_mean   "
"1","   9682.5"
"1","    10297.2"
"1","   0.940"
"1","   0.3517"
"1","  "
"1","
X11_mean   "
"1","  -4053.8"
"1","    10926.7"
"1","  -0.371"
"1","   0.7122"
"1","  "
"1","
X12_mean   "
"1","   4343.0"
"1","     3360.3"
"1","   1.292"
"1","   0.2023"
"1","  "
"1","
X13_mean   "
"1","  -4533.9"
"1","     4696.0"
"1","  -0.965"
"1","   0.3391"
"1","  "
"1","
X14_mean   "
"1"," -24127.4"
"1","    12507.5"
"1","  -1.929"
"1","   0.0595"
"1"," ."
"1","
X15_mean   "
"1","  10685.4"
"1","     7914.9"
"1","   1.350"
"1","   0.1832"
"1","  "
"1","
X16_mean   "
"1","  -8359.7"
"1","     5085.7"
"1","  -1.644"
"1","   0.1066"
"1","  "
"1","
X17_mean   "
"1","  16131.5"
"1","    12470.8"
"1","   1.294"
"1","   0.2019"
"1","  "
"1","
X20_mean   "
"1"," -46751.4"
"1","    34508.2"
"1","  -1.355"
"1","   0.1817"
"1","  "
"1","
X21_mean   "
"1"," -20000.3"
"1","    26871.3"
"1","  -0.744"
"1","   0.4602"
"1","  "
"1","
X22_mean   "
"1","  96007.5"
"1","    57448.0"
"1","   1.671"
"1","   0.1011"
"1","  "
"1","
X23_mean   "
"1","  18778.4"
"1","    18818.6"
"1","   0.998"
"1","   0.3232"
"1","  "
"1","
X24_mean   "
"1"," -31697.7"
"1","    19644.1"
"1","  -1.614"
"1","   0.1130"
"1","  "
"1","
X25_mean   "
"1","   9052.0"
"1","    18169.7"
"1","   0.498"
"1","   0.6206"
"1","  "
"1","
X26_mean   "
"1"," -19186.3"
"1","    18699.2"
"1","  -1.026"
"1","   0.3099"
"1","  "
"1","
X30_mean   "
"1","   9861.9"
"1","    31803.4"
"1","   0.310"
"1","   0.7578"
"1","  "
"1","
X31_mean   "
"1"," -84186.3"
"1","    59233.5"
"1","  -1.421"
"1","   0.1616"
"1","  "
"1","
X32_mean   "
"1"," -10462.4"
"1","    23625.3"
"1","  -0.443"
"1","   0.6598"
"1","  "
"1","
X33_mean   "
"1","  36107.5"
"1","    22711.0"
"1","   1.590"
"1","   0.1183"
"1","  "
"1","
X34_mean   "
"1"," -14340.9"
"1","    19239.2"
"1","  -0.745"
"1","   0.4596"
"1","  "
"1","
X35_mean   "
"1","  11499.9"
"1","    24122.7"
"1","   0.477"
"1","   0.6357"
"1","  "
"1","
X40_mean   "
"1"," -13160.0"
"1","    10281.3"
"1","  -1.280"
"1","   0.2066"
"1","  "
"1","
X41_mean   "
"1","   1673.7"
"1","     9568.8"
"1","   0.175"
"1","   0.8619"
"1","  "
"1","
X42_mean   "
"1","   1814.1"
"1","     7096.7"
"1","   0.256"
"1","   0.7993"
"1","  "
"1","
X43_mean   "
"1","    224.5"
"1","     6850.0"
"1","   0.033"
"1","   0.9740"
"1","  "
"1","
X44_mean   "
"1","  -1733.7"
"1","     9476.4"
"1","  -0.183"
"1","   0.8556"
"1","  "
"1","
X50_mean   "
"1","  -2244.3"
"1","    11677.5"
"1","  -0.192"
"1","   0.8484"
"1","  "
"1","
X51_mean   "
"1"," -11827.2"
"1","     9171.8"
"1","  -1.290"
"1","   0.2033"
"1","  "
"1","
X52_mean   "
"1","   8269.6"
"1","     8871.0"
"1","   0.932"
"1","   0.3558"
"1","  "
"1","
X53_mean   "
"1","   4404.6"
"1","     9390.4"
"1","   0.469"
"1","   0.6411"
"1","  "
"1","
X60_mean   "
"1","   2100.3"
"1","    25843.1"
"1","   0.081"
"1","   0.9356"
"1","  "
"1","
X61_mean   "
"1","   3443.2"
"1","    12107.4"
"1","   0.284"
"1","   0.7773"
"1","  "
"1","
X62_mean   "
"1","  -2781.4"
"1","    14845.3"
"1","  -0.187"
"1","   0.8522"
"1","  "
"1","
X70_mean   "
"1","   4497.4"
"1","     8933.0"
"1","   0.503"
"1","   0.6169"
"1","  "
"1","
X71_mean   "
"1","  -2176.5"
"1","    23757.7"
"1","  -0.092"
"1","   0.9274"
"1","  "
"1","
X80_mean   "
"1","   8997.0"
"1","    12909.6"
"1","   0.697"
"1","   0.4891"
"1","  "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","2.967"
"1"," "
"1","on"
"1"," "
"1","49"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.6162"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.2637"
"1"," "
"1","
F-statistic:"
"1"," "
"1","1.748"
"1"," "
"1","on"
"1"," "
"1","45"
"1"," "
"1","and"
"1"," "
"1","49"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","0.02859"
"1","
"
"1","
"
"0","# predict using test data"
"0","predictions <- lm.fit %>% predict(test.data)"
"0",""
"0","# compute R MSE"
"0","RMSE <- RMSE(predictions, test.data$sdwt)"
"0",""
"0","# compute R-square"
"0","R2 <- R2(predictions, test.data$sdwt)"
"0",""
"0","# return results"
"0","print(paste(""RMSE = "", RMSE))"
"1","[1]"
"1"," ""RMSE =  4.54427919800429"""
"1","
"
"0","print(paste(""R-squared value is:"", R2))"
"1","[1]"
"1"," ""R-squared value is: 0.0625971443282952"""
"1","
"
